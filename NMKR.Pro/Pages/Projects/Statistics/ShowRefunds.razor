@page "/refunds/{customerid:int}/{projectid:int}"
@inject AppSettings settings
@inject ISnackbar Snackbar
@inject NavigationManager NavigationManager
@inject IBlazorDownloadFileService BlazorDownloadFileService
@inject IConnectionMultiplexer _redis;

<BreadCrumb Items="_items"></BreadCrumb>

<MudContainer MaxWidth="MaxWidth.False" Class="mt-4">

<MudText Typo="Typo.h3" Color="Color.Dark" Class="mb-4">Refunds - @project.Id - @project.Projectname</MudText>
<RefundList customerid="@customerid" projectid="@projectid" Redis="_redis" ></RefundList>
 


</MudContainer>



@code {
    [Parameter]
    public int customerid { get; set; }
    [Parameter]
    public int projectid { get; set; }


    private readonly List<BreadcrumbItem> _items = new();

    private Nftproject project = new();

    protected override async Task OnParametersSetAsync()
    {
        await using var _db = new EasynftprojectsContext(GlobalFunctions.optionsBuilder.Options);
        project = await (from a in _db.Nftprojects
            where a.CustomerId == customerid
                  && a.State != "deleted" && a.Id == projectid
            select a).FirstOrDefaultAsync();


        if (projectid != 0)
        {
            _items.Add(new("Customers", href: "/customers"));
            _items.Add(new("NFT Projects", href: "/projects/"));
            _items.Add(new("NFT Projects (CustomerId: " + customerid + ")", href: "/projects/" + customerid));
            _items.Add(new("Refunds (" + project.Projectname + ")", href: "/refunds/" + customerid + "/" + projectid, disabled: true));
        }
    }


}
